{% extends "base.html" %}

{% block content %}
    <div class="content-header">
        <div class="breadcrumb-nav">
            <span>Workspace</span> / <span>Cash Overview</span>
        </div>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="mt-3" id="flash-messages">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} fade-out" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <div class="balance-section mt-4">
        <h3>Cash Flow Overview</h3>
        <div class="row">
            <div class="col">
                <div class="balance-item">
                    <h5>Initial Cash Balance</h5>
                    <p>${{ initial_balance }}</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="balance-item">
                    <h5>CFO (Cashflow from Operation)</h5>
                    <p>${{ total_cfo }}</p>
                </div>
            </div>
            <div class="col">
                <div class="balance-item">
                    <h5>CFI (Cashflow from Investment)</h5>
                    <p>${{ total_cfi }}</p>
                </div>
            </div>
            <div class="col">
                <div class="balance-item">
                    <h5>CFF (Cashflow from Financing)</h5>
                    <p>${{ total_cff }}</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="balance-item">
                    <h5>Latest Cash Balance</h5>
                    <p>${{ balance }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Monthly Balance Chart Section -->
    <div class="monthly-chart-section mt-4">
        <h3>Monthly Balance Trend</h3>
        <div class="chart-container">
            <img id="monthly-balance-chart" class="img-fluid" alt="Monthly Balance Chart">
        </div>
    </div>

    <!-- Form to set the initial balance -->
    <div class="initial-balance-section mt-4">
        <form method="POST" action="{{ url_for('set_initial_balance') }}">
            <h3>Set Initial Cash Balance</h3>
            <div class="mb-3">
                <input type="number" step="0.01" class="form-control" id="initial_balance" name="initial_balance" required>
            </div>
            <button type="submit" class="btn btn-secondary">Set Initial Balance</button>
        </form>
    </div>
{% endblock %} 